1) DHCP: появление нового устройства
(Устройство подключилось к сети и запросило IP.)

Что ловим:
	•	DHCP Discover / Offer / Request / Ack
	•	MAC-адрес
	•	Выданный IP
	•	Hostname (если есть)
	•	Время

Что сразу понимаем:
	•	новое устройство в сети
	•	текущее количество активных клиентов
	•	“кто это” (по MAC vendor + hostname)

2) DHCP: переполучение / смена IP
(Устройство обновляет lease или получает новый IP.)

Что ловим:
	•	DHCP Request без Discover
	•	MAC → старый IP → новый IP

Что понимаем:
	•	устройство давно в сети
	•	смена IP (норм/ненорм)
	•	DHCP нестабилен? (частые renew)

3) ARP: кто есть кто в сети

Что происходит:
Устройства узнают MAC друг друга.

Что ловим:
	•	ARP request/reply
	•	IP ↔ MAC

Что понимаем:
	•	реальная топология LAN
	•	соответствие DHCP ↔ ARP
	•	внезапные дубликаты IP
	•	первые признаки ARP-spoof (позже)

4) DNS-запросы: чем живёт устройство

Что ловим:
	•	src IP
	•	домен
	•	тип запроса (A/AAAA)
	•	частота

Что понимаем:
	•	“чем занимается устройство” (YouTube, Steam, Apple, Google)
	•	новое устройство → куда лезет сразу
	•	подозрительные домены (потом можно добавить список)

5) Фоновая болтовня устройств (IoT / телефоны)

Что происходит:
Телевизор, телефон, умная колонка постоянно общаются.

Что ловим:
	•	регулярные маленькие flows
	•	одинаковые dst IP/домены

Что понимаем:
	•	baseline поведения устройства
	•	кто “шумит” больше всех
	•	внезапный рост активности

6) Всплеск трафика у одного клиента

Что происходит:
Резко выросли bytes/sec или pps.

Что ловим:
	•	flow stats
	•	baseline vs текущие значения

Что понимаем:
	•	торрент
	•	апдейт
	•	стрим

7) Кто сейчас в сети (snapshot)

Что строим:
	•	активные IP за последние X минут
	•	last seen
	•	тип устройства (грубо)

Что даёт:
	•	“картина сети сейчас”
	•	очень удобно для UI

8) Топология: кто с кем общается

Что строим:
	•	граф: IP → IP
	•	толщина ребра = объём

Что понимаем:
	•	локальные взаимодействия
	•	выходы наружу
	•	лишние связи

9) Сканирование портов внутри сети

Что происходит:
Один IP перебирает много портов на другом.

Что ловим:
	•	src IP → dst IP
	•	много dst_port за короткое время

Что понимаем:
	•	nmap?
	•	любопытство?
	•	повод уведомить, но не орать
