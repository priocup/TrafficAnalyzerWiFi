Шаг 1. Подготовка
- Сервак (тачка на линуксе или винде со скриптом)
- Настроенный ssh (спускаем данный шаг к моменту теста скрипта)
Шаг 2. Захват трафика
Так как у тебя OpenWRT
- Ставим tcpdump
- Скрипт который пишет трафик и сохраняет кусками pcap (5-20 Мб), забираем только файлы которые не обновляются а уже готовы, забираемый файл удаляется дабы освободить место 
(можно использовать флешку для хранения)
- настроить автозапуск скрипта
Шаг 3. Сбор трафика
- обращаемся к шагу 1 с ssh, собираем pcap файлы
- Скрипт на ПК обработка трафика по заданным шаблонам
Шаг 4. Оповещение
- настроить оповещения в ТГ
Шаг 5. UI
- Можно сделать UI в которой будут отображаться пакеты (wireshark) + топология сети (как ты делал на дипломе)
